# Geminiè‡ªæ ‡æ³¨ä¸å­ªç”Ÿç½‘ç»œé©±åŠ¨çš„ä¹å®«æ ¼éªŒè¯ç è¯†åˆ«

## é¡¹ç›®ä»‹ç»

â€‹	æˆ‘ä»¬åœ¨ä½¿ç”¨ä¼ ç»Ÿæ–¹æ¡ˆè¿›è¡Œä¹å®«æ ¼éªŒè¯ç è¯†åˆ«å¾€å¾€å­˜åœ¨æ•°æ®é‡‡é›†éš¾ã€æ•°æ®æ ‡æ³¨è€—æ—¶è€—åŠ›ã€è®­ç»ƒæ…¢ç­‰é—®é¢˜ï¼Œæœ¬é¡¹ç›®é‡‡ç”¨Playwrightå®ç°æ•°æ®é›†è‡ªåŠ¨åŒ–é‡‡é›†ã€ä¾èµ–äºGemini 2.5 Proå¤šæ¨¡æ€å¤§æ¨¡å‹å®ç°çš„æ•°æ®é›†è‡ªåŠ¨æ ‡æ³¨ã€åŸºäºResNet-18å®ç°çš„å­ªç”Ÿç¥ç»ç½‘ç»œï¼Œå®ç°äº†ä¸€å¥—å®Œå…¨ç”±è‡ªåŠ¨åŒ–é©±åŠ¨çš„ä¹å®«æ ¼ç±»éªŒè¯ç è¯†åˆ«è§£å†³æ–¹æ¡ˆã€‚

![image-20250830030007900](./assets/image-20250830030007900.png)



## é¡¹ç›®ç»“æ„

```
project/
â”œâ”€â”€ README.md                             # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ annotation.py                         # è‡ªåŠ¨æ ‡æ³¨è„šæœ¬
â”œâ”€â”€ best_siamese_model.pth                # æ¨¡å‹æ–‡ä»¶
â”œâ”€â”€ plot_training.py                      # è®­ç»ƒæ—¥å¿—è½¬å¯è§†åŒ–å›¾
â”œâ”€â”€ remove_fail_data.py                   # å¤„ç†é”™è¯¯æ ‡æ³¨çš„æ•°æ®è„šæœ¬
â”œâ”€â”€ requirements.txt                      # ä¾èµ–
â”œâ”€â”€ siamese_network.py                    # ç¥ç»ç½‘ç»œç»“æ„
â”œâ”€â”€ spider_geetest.py                     # æ•°æ®é›†çˆ¬è™«
â”œâ”€â”€ test.py                               # æ¨ç†æµ‹è¯•
â”œâ”€â”€ train.py                              # è®­ç»ƒè„šæœ¬
â””â”€â”€ visual_test.py                        # å¯è§†åŒ–æµ‹è¯•

```



## å·¥ä½œæµç¨‹

```mermaid
graph LR
    A[æ•°æ®é‡‡é›†] --> B[AIæ ‡æ³¨]
    B --> C[æ•°æ®æ¸…ç†]
    C --> D[æ¨¡å‹è®­ç»ƒ]
    D --> E[æ¨¡å‹éªŒè¯]
    E --> F[å¯è§†åŒ–æµ‹è¯•]
    F --> G[æ¨¡å‹éƒ¨ç½²]
```



## ç¯å¢ƒè¦æ±‚

### ç³»ç»Ÿè¦æ±‚
- Python 3.9+
- æ”¯æŒCUDAçš„GPU (æ¨è) æˆ– Apple Silicon MPS

### æ ¸å¿ƒä¾èµ–
```bash
torch
torchvision
requests
Pillow
python-dotenv
playwright
opencv-python
numpy
```



## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/u-wlkjyy/siam-autolabel.git
cd siam-autolabel

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å®‰è£…playwrightæµè§ˆå™¨é©±åŠ¨
playwright install
```



### 2. ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º`.env`æ–‡ä»¶å¹¶é…ç½®AIæœåŠ¡ï¼š

```bash
API_KEY=your_gemini_api_key
BASE_URL=gemini_api_server
```



### 3. æ•°æ®é‡‡é›† 

```bash
python spider_geetest.py
```

å¦‚æœå¸Œæœ›é‡‡é›†ä¸€äº›æµ‹è¯•æ•°æ®ï¼Œå¯ä»¥ä¿®æ”¹ä»£ç ä¸­output_pathä½ç½®ä¸º``./tests``ç›®å½•å³å¯

```python
output_path = './tests'
```

**è¯´æ˜:**

- å·¥ä½œçº¿ç¨‹æ•°: 16ä¸ªå¹¶å‘çº¿ç¨‹
- ç›®æ ‡ç½‘ç«™: https://account.siliconflow.cn/zh/login
- è¾“å‡ºç›®å½•: `./output/`
- æ¯ä¸ªæ ·æœ¬åŒ…å«: `full.png`(å®Œæ•´éªŒè¯ç å›¾ç‰‡) + `question.png`(é—®é¢˜å›¾ç‰‡) + `geetest_0.png` åˆ° `geetest_8.png`(ä¹å®«æ ¼å€™é€‰å›¾ç‰‡)



### 4. æ•°æ®è‡ªåŠ¨æ ‡æ³¨ (å¯é€‰)

å¯¹é‡‡é›†çš„æ•°æ®è¿›è¡ŒAIè‡ªåŠ¨æ ‡æ³¨ï¼š

```bash
python annotation.py
```

æ ‡æ³¨å®Œæˆåæ¸…ç†æ ‡æ³¨æœ‰è¯¯çš„æ•°æ®

```bash
python remove_fail_data.py
```



### 5. æ¨¡å‹è®­ç»ƒ

```bash
python train.py --epochs 1000 --batch_size 32 --lr 0.001
```

åœ¨**macOS**ä¸‹è®­ç»ƒå°†**cpu**ä¿®æ”¹ä¸º**mps**å¯è·å¾—è¾ƒå¤§çš„æ€§èƒ½æå‡

```python
# æ£€æŸ¥CUDAå¯ç”¨æ€§
device = torch.device('cuda' if torch.cuda.is_available() else 'mps')
```



**è®­ç»ƒå‚æ•°è¯´æ˜:**

- `--dataset_path`: æ•°æ®é›†è·¯å¾„ (é»˜è®¤: `./dataset`)
- `--batch_size`: æ‰¹æ¬¡å¤§å° (é»˜è®¤: 32)
- `--epochs`: è®­ç»ƒè½®æ•° (é»˜è®¤: 1000)
- `--lr`: å­¦ä¹ ç‡ (é»˜è®¤: 0.001)
- `--feature_dim`: ç‰¹å¾ç»´åº¦ (é»˜è®¤: 512)



### 6. å¯è§†åŒ–æµ‹è¯•

æ¨¡å‹è®­ç»ƒå®Œæˆåï¼Œå°†è®­ç»ƒçš„æ¨¡å‹æ–‡ä»¶æ‹–åˆ°é¡¹ç›®ç›®å½•ä¸Šï¼Œè¿è¡Œä¸‹é¢å‘½ä»¤å¯ä»¥å¯è§†åŒ–æ˜¾ç¤ºæ¨¡å‹æ€§èƒ½ã€‚

```bash
python visual_test.py
```

**æ“ä½œè¯´æ˜:**

- `ç©ºæ ¼é”®`: ä¸‹ä¸€ä¸ªæµ‹è¯•æ ·æœ¬
- `pé”®`: ä¸Šä¸€ä¸ªæµ‹è¯•æ ·æœ¬
- `sé”®`: ä¿å­˜å½“å‰ç»“æœå›¾ç‰‡
- `qé”®`: é€€å‡ºæµ‹è¯•



## æ¨¡å‹æ¶æ„

### å­ªç”Ÿç¥ç»ç½‘ç»œç»“æ„

```
è¾“å…¥å›¾ç‰‡å¯¹ (224x224x3)
       â†“
ResNet-18ç‰¹å¾æå–å™¨ (å…±äº«æƒé‡)
       â†“
ç‰¹å¾å‘é‡ (512ç»´)
       â†“
L2å½’ä¸€åŒ–
       â†“
ç‰¹å¾è¿æ¥ + ç›¸ä¼¼åº¦è®¡ç®—
       â†“
è¾“å‡ºç›¸ä¼¼åº¦åˆ†æ•° (0-1)
```

### æŸå¤±å‡½æ•°

- **BCEæŸå¤±**: äºŒåˆ†ç±»äº¤å‰ç†µæŸå¤±
- **å¯¹æ¯”æŸå¤±**: åŸºäºæ¬§æ°è·ç¦»çš„å¯¹æ¯”å­¦ä¹ æŸå¤±
- **ç»„åˆæŸå¤±**: `æ€»æŸå¤± = BCEæŸå¤± + 0.5 Ã— å¯¹æ¯”æŸå¤±`



## æ•°æ®é›†è¯´æ˜

### æ•°æ®ç»“æ„
```
æ ·æœ¬ç›®å½•/
â”œâ”€â”€ question.png           # é—®é¢˜å›¾ç‰‡ (éªŒè¯ç æŒ‡ä»¤)
â”œâ”€â”€ geetest_0.png         # è´Ÿæ ·æœ¬1
â”œâ”€â”€ geetest_1.png         # è´Ÿæ ·æœ¬2
â”œâ”€â”€ ...                   # ...
â”œâ”€â”€ geetest_8.png         # è´Ÿæ ·æœ¬9
â”œâ”€â”€ geetest_answer_1.png  # æ­£æ ·æœ¬1
â””â”€â”€ geetest_answer_2.png  # æ­£æ ·æœ¬2
```



## ä½¿ç”¨ç¤ºä¾‹

### å•å¼ å›¾ç‰‡é¢„æµ‹

å»ºè®®ä½¿ç”¨æ‰¹é‡é¢„æµ‹ï¼Œå–å‰ä¸‰ä¸ªç›¸ä¼¼çš„å›¾ç‰‡ä½œä¸ºç»“æœå¯ä¿è¯æœ€ä½³æ€§èƒ½ï¼

```python
from siamese_network import SiameseNetwork, get_transforms, predict_similarity
import torch

# åŠ è½½æ¨¡å‹
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model = SiameseNetwork(feature_dim=512).to(device)
model.load_state_dict(torch.load('best_siamese_model.pth', map_location=device))

# è·å–æ•°æ®å˜æ¢
_, transform = get_transforms()

# é¢„æµ‹ç›¸ä¼¼åº¦
result = predict_similarity(
    model=model,
    img1_path='question.png',
    img2_path='candidate.png', # é€‰é¡¹å›¾ç‰‡
    transform=transform,
    device=device
)

print(f"ç›¸ä¼¼åº¦åˆ†æ•°: {result['similarity_score']:.3f}")
print(f"æ˜¯å¦ç›¸ä¼¼: {result['is_similar']}")
```



### æ‰¹é‡é¢„æµ‹

```python
import glob
import os

test_dir = './tests/sample_folder'
question_path = os.path.join(test_dir, 'question.png')
candidates = sorted(glob.glob(os.path.join(test_dir, 'geetest_*.png')))

results = []
for candidate in candidates:
    result = predict_similarity(model, question_path, candidate, transform, device)
    results.append({
        'file': candidate,
        'similarity': result['similarity_score'],
        'is_match': result['is_similar']
    })

# æŒ‰ç›¸ä¼¼åº¦æ’åº
results.sort(key=lambda x: x['similarity'], reverse=True)
print("é¢„æµ‹ç»“æœ (æŒ‰ç›¸ä¼¼åº¦æ’åº):")
for r in results[:3]:  # æ˜¾ç¤ºå‰3ä¸ªæœ€ç›¸ä¼¼çš„
    print(f"{os.path.basename(r['file'])}: {r['similarity']:.3f}")
```



## æ€§èƒ½æŒ‡æ ‡

ä½ å¯èƒ½ä¼šæå‡ºâ€œ**éœ€è¦è®­ç»ƒå¤šä¹…å‘€ï¼Ÿ**â€ã€â€œ**å‡†ç¡®ç‡èƒ½è¾¾åˆ°å¤šå°‘ï¼Ÿ**â€ç­‰ç­‰ä¸€äº›åˆ—é—®é¢˜ï¼Œåœ¨è¿™é‡Œåšç»Ÿä¸€çš„è§£ç­”ã€‚

åœ¨è¿™é‡Œæˆ‘ä½¿ç”¨äº†é»˜è®¤é…ç½®ï¼Œåœ¨AutoDLå¹³å°ä¸­ä½¿ç”¨äº†``RTX Geforce 5090 32GB``è¿›è¡Œè®­ç»ƒåšå‡ºçš„æ•°æ®ç»Ÿè®¡ï¼Œå…·ä½“é…ç½®å¯ä»¥å‚è€ƒä¸‹å›¾ã€‚

![image-20250830033002148](./assets/image-20250830033002148.png)



ä»¥ä¸‹æ˜¯è®­ç»ƒ15åˆ†é’Ÿçš„æ—¥å¿—

```bash
æ¨¡å‹æ€»å‚æ•°æ•°: 11,997,249
å¯è®­ç»ƒå‚æ•°æ•°: 11,997,249
å¼€å§‹è®­ç»ƒ...
Epoch 1/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.4175 ETA: 00:00 19.8it/s
Validating...
Epoch 1/1000: train_loss=0.4175 val_acc=0.9486 lr=0.001000 time=56.0s
ğŸ† New best model saved! Val Acc: 0.9486
--------------------------------------------------------------------------------
Epoch 2/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.2298 ETA: 00:00 21.5it/s
Validating...
Epoch 2/1000: train_loss=0.2298 val_acc=0.9651 lr=0.001000 time=52.2s
ğŸ† New best model saved! Val Acc: 0.9651
--------------------------------------------------------------------------------
Epoch 3/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1913 ETA: 00:00 21.2it/s
Validating...
Epoch 3/1000: train_loss=0.1913 val_acc=0.9752 lr=0.001000 time=52.4s
ğŸ† New best model saved! Val Acc: 0.9752
--------------------------------------------------------------------------------
Epoch 4/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1765 ETA: 00:00 21.6it/s
Validating...
Epoch 4/1000: train_loss=0.1765 val_acc=0.9656 lr=0.001000 time=51.6s
--------------------------------------------------------------------------------
Epoch 5/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1623 ETA: 00:00 20.9it/s
Validating...
Epoch 5/1000: train_loss=0.1623 val_acc=0.9781 lr=0.001000 time=54.0s
ğŸ† New best model saved! Val Acc: 0.9781
--------------------------------------------------------------------------------
Epoch 6/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1466 ETA: 00:00 21.5it/s
Validating...
Epoch 6/1000: train_loss=0.1466 val_acc=0.9808 lr=0.001000 time=51.8s
ğŸ† New best model saved! Val Acc: 0.9808
--------------------------------------------------------------------------------
Epoch 7/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1531 ETA: 00:00 21.7it/s
Validating...
Epoch 7/1000: train_loss=0.1531 val_acc=0.9824 lr=0.001000 time=51.4s
ğŸ† New best model saved! Val Acc: 0.9824
--------------------------------------------------------------------------------
Epoch 8/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1330 ETA: 00:00 21.1it/s
Validating...
Epoch 8/1000: train_loss=0.1330 val_acc=0.9813 lr=0.001000 time=53.0s
--------------------------------------------------------------------------------
Epoch 9/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1386 ETA: 00:00 21.5it/s
Validating...
Epoch 9/1000: train_loss=0.1386 val_acc=0.9769 lr=0.001000 time=51.7s
--------------------------------------------------------------------------------
Epoch 10/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1278 ETA: 00:00 21.4it/s
Validating...
Epoch 10/1000: train_loss=0.1278 val_acc=0.9794 lr=0.001000 time=52.1s
--------------------------------------------------------------------------------
Epoch 11/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1251 ETA: 00:00 20.9it/s
Validating...
Epoch 11/1000: train_loss=0.1251 val_acc=0.9753 lr=0.001000 time=53.2s
--------------------------------------------------------------------------------
Epoch 12/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1220 ETA: 00:00 21.6it/s
Validating...
Epoch 12/1000: train_loss=0.1220 val_acc=0.9818 lr=0.001000 time=51.6s
--------------------------------------------------------------------------------
Epoch 13/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1174 ETA: 00:00 20.4it/s
Validating...
Epoch 13/1000: train_loss=0.1174 val_acc=0.9763 lr=0.001000 time=54.4s
--------------------------------------------------------------------------------
Epoch 14/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1152 ETA: 00:00 21.1it/s
Validating...
Epoch 14/1000: train_loss=0.1152 val_acc=0.9786 lr=0.001000 time=52.8s
--------------------------------------------------------------------------------
Epoch 15/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1202 ETA: 00:00 20.3it/s
Validating...
Epoch 15/1000: train_loss=0.1202 val_acc=0.9805 lr=0.001000 time=54.5s
```

ç»è¿‡æµ‹è¯•ï¼Œåœ¨ç¬¬7ä¸ªEpochæ—¶èƒ½è¾¾åˆ°æœ€å¥½çš„æ€§èƒ½æ•ˆæœï¼Œç²¾åº¦è¾¾åˆ°**0.9824**ï¼Œåœ¨åç»­è®­ç»ƒä¸­åŸºæœ¬ä¸Šè·‘ä¸åŠ¨äº†ï¼Œç”¨æ—¶çº¦5åˆ†é’Ÿã€‚

```bash
Epoch 7/1000 |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 993/993 [100.0%] loss: 0.1531 ETA: 00:00 21.7it/s
Validating...
Epoch 7/1000: train_loss=0.1531 val_acc=0.9824 lr=0.001000 time=51.4s
ğŸ† New best model saved! Val Acc: 0.9824
```

æ›²çº¿å›¾å¦‚ä¸‹ï¼š

![image-20250830033728540](./assets/image-20250830033728540.png)



## å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ä¾›å­¦æœ¯ç ”ç©¶å’ŒæŠ€æœ¯äº¤æµä½¿ç”¨ï¼Œæ ¸å¿ƒç›®çš„æ˜¯æ¢ç´¢å¤šæ¨¡æ€å¤§æ¨¡å‹åœ¨è‡ªåŠ¨åŒ–å›¾åƒæ ‡æ³¨é¢†åŸŸçš„åº”ç”¨ï¼Œä»¥åŠå­ªç”Ÿç¥ç»ç½‘ç»œåœ¨ç‰¹å®šè¯†åˆ«ä»»åŠ¡ä¸­çš„å®ç°ã€‚ 

**ä¸¥ç¦**å°†æœ¬é¡¹ç›®çš„ä»»ä½•éƒ¨åˆ†ï¼ˆåŒ…æ‹¬ä»£ç ã€æ¨¡å‹ã€æ•°æ®é›†ç­‰ï¼‰ç”¨äºä»¥ä¸‹ç›®çš„ï¼š 

1. ä»»ä½•å½¢å¼çš„å•†ä¸šç”¨é€”æˆ–ç›ˆåˆ©æ´»åŠ¨ã€‚ 
2. å¯¹ä»»ä½•ç½‘ç«™æˆ–ç³»ç»Ÿè¿›è¡Œå¤§è§„æ¨¡ã€æœªæˆæƒçš„çˆ¬å–ã€æŠ“å–æˆ–æ”»å‡»ã€‚ 
3. ç ´è§£ã€ç»•è¿‡ä»»ä½•å½¢å¼çš„éªŒè¯ç æˆ–å®‰å…¨é˜²æŠ¤æªæ–½ã€‚ 
4. ä»»ä½•è¿åç›¸å…³æ³•å¾‹æ³•è§„æˆ–ä¾µçŠ¯ç¬¬ä¸‰æ–¹åˆæ³•æƒç›Šçš„è¡Œä¸ºã€‚



ä½¿ç”¨è€…åœ¨ä½¿ç”¨æœ¬é¡¹ç›®æ—¶ï¼Œå¿…é¡»å……åˆ†ç†è§£å¹¶åŒæ„ï¼š

* æœ¬é¡¹ç›®çš„ä½œè€…å’Œè´¡çŒ®è€…**ä¸æ‰¿æ‹…**å› ä½¿ç”¨è€…æ»¥ç”¨ã€ä¸å½“ä½¿ç”¨æˆ–è¿åæœ¬å£°æ˜è€Œå¯¼è‡´çš„ä»»ä½•ç›´æ¥æˆ–é—´æ¥è´£ä»»ã€é£é™©æˆ–æŸå¤±ã€‚ 
* ä½¿ç”¨è€…éœ€è‡ªè¡Œæ‰¿æ‹…æ‰€æœ‰å› ä½¿ç”¨æœ¬é¡¹ç›®è€Œäº§ç”Ÿçš„åæœå’Œæ³•å¾‹è´£ä»»ã€‚ 



å¦‚æœæ‚¨ä¸‹è½½ã€å®‰è£…ã€ä½¿ç”¨æˆ–åˆ†å‘æœ¬é¡¹ç›®ï¼Œå³ä»£è¡¨æ‚¨å·²å……åˆ†é˜…è¯»ã€ç†è§£å¹¶æ¥å—æœ¬å£°æ˜çš„æ‰€æœ‰æ¡æ¬¾ã€‚



## è‡´è°¢

æœ¬é¡¹ç›®ä½¿ç”¨ [PyCharm](https://www.jetbrains.com/pycharm/) å¼€å‘ï¼Œæ„Ÿè°¢ [JetBrains](https://www.jetbrains.com/) å…¬å¸ä¸ºå­¦ç”Ÿæä¾›çš„å…è´¹è®¸å¯è¯ã€‚![PyCharm](./assets/PyCharm-143-20250830164007215.svg)

- æ„Ÿè°¢ [@ä¸ƒå½©äº‘èµ„æºç½‘](http://www.qicaiy.cn) ä¸ºæœ¬é¡¹ç›®æä¾›è‡ªåŠ¨åŒ–æ•°æ®æ ‡æ³¨æä¾›äº†Gemini API

  